# Customer Churn Prediction

## Project Overview
- This projects predicts whether a customer is likely to stop using a company's services (ie. 'Churn') based on historical data.
- It's designed for Telecommunication companies but can be adapted to other industries.
- The project includes two main components: model training (main.py) and a web application (app.py) for interactive prediction.

## Project files
1. Dataset: Telco Customer Churn sourced from HuggingFace
    
    The dataset contains information about customers of a fictional telecommunications company, including demographic information, services subscribed to, location details, and churn behavior. The dataset combines the information from the original Telco Customer Churn dataset with additional details.

    The dataset is structured as a CSV file with 49 columns, each representing a customer attribute. The columns include:

    * Age: The customer's age in years.
    * Avg Monthly GB Download: The customer's average monthly gigabyte download volume.
    * Avg Monthly Long Distance Charges: The customer's average monthly long distance charges.
    * Churn Category: A high-level category for the customer's reason for churning.
    * Churn Label: Indicates whether the customer churned.
    * Churn Reason: The customer's specific reason for leaving the company.
    * Churn Score: A score from 0-100 indicating the likelihood of the customer churning.
    * Churn Value: A numerical value representing whether the customer churned (1 for churned, 0 for not churned).
    * City: The city of the customer's residence.
    * CLTV: Customer Lifetime Value.
    * Contract: The customer's contract type.
    * Country: The country of the customer's residence.
    * Customer ID: A unique identifier for each customer.
    * Customer Status: The customer's status at the end of the quarter (Churned, Stayed, or Joined).
    * Dependents: Whether the customer has dependents.
    * Device Protection Plan: Whether the customer has a device protection plan.
    * Gender: The customer's gender.
    * Internet Service: Indicates whether the customer subscribes to internet service.
    * Internet Type: The type of internet service provider.
    * Lat Long: The combined latitude and longitude of the customer's residence.
    * Latitude: The latitude of the customer's residence.
    * Longitude: The longitude of the customer's residence.
    * Married: Indicates if the customer is married.
    * Monthly Charge: The customer's total monthly charge for all their services.
    * Multiple Lines: Whether the customer has multiple phone lines.
    * Number of Dependents: The number of dependents the customer has.
    * Number of Referrals: The number of referrals made by the customer.
    * Offer: The last marketing offer the customer accepted.
    * Online Backup: Whether the customer has online backup service.
    * Online Security: Whether the customer has online security service.
    * Paperless Billing: Whether the customer has paperless billing.
    * Partner: Whether the customer has a partner.
    * Payment Method: The customer's payment method.
    * Phone Service: Whether the customer has phone service.
    * Population: The estimated population of the customer's zip code.
    * Premium Tech Support: Whether the customer has premium tech support.
    * Quarter: The fiscal quarter for the data.
    * Referred a Friend: Indicates if the customer has referred a friend.
    * Satisfaction Score: The customer's satisfaction rating.
    * Senior Citizen: Whether the customer is a senior citizen.
    * State: The state of the customer's residence.
    * Streaming Movies: Whether the customer has streaming movies service.
    * Streaming Music: Whether the customer has streaming music service.
    * Streaming TV: Whether the customer has streaming TV service.
    * Tenure in Months: The number of months the customer has been with the company.
    * Total Charges: The customer's total charges.
    * Total Extra Data Charges: The total charges for extra data downloads.
    * Total Long Distance Charges: The total charges for long distance calls.
    * Total Refunds: The total refunds received by the customer.
    * Total Revenue: The total revenue generated by the customer.
    * Under 30: Indicates if the customer is under 30 years old.
    * Unlimited Data: Whether the customer has unlimited data.
    * Zip Code: The zip code of the customer's residence.

2. main.py:
    * Libraries Used : 
        * pandas : for data manipulation
        * pycaret.classification : for automated machine learning workflow.

    * Workflow:
        1. Load Dataset: Loads customer data from Dataset/train.csv.
        2. Ignore Non-Predictive Features: Certain columns such as customer ID, location details, and churn reasons are excluded from modeling to avoid leakage.
        3. Initialize PyCaret: Sets up the classification experiment with normalization, target variable Churn, and ignored features.
        4. Model Comparison: Uses PyCaret’s compare_models() to test multiple classification algorithms and selects the best performing one.
        5. Model Finalization: Finalizes the best model to prepare it for deployment.
        6. Model Evaluation: Provides an interactive interface to evaluate the finalized model's performance metrics.
        7. Model Saving: Saves the finalized model as churn_model for later use.

    * Output:

        * Trained and saved churn prediction model ready for inference.

3. app.py:
    * Libraries Used
        * streamlit: For building the interactive web app interface.
        * pandas: To organize user inputs into a DataFrame.
        * pycaret.classification: To load the saved model and perform prediction.

    * Workflow
        1. Load Model: Loads the trained churn_model.
        2. User Input: Collects customer details using Streamlit widgets including age, contract type, service subscriptions, monthly charges, and more.
        3. Input Processing: Converts "Yes"/"No" inputs to numerical format (1/0) as required by the model.
        4. Prediction: Upon clicking "Predict Churn", the app creates a DataFrame of inputs and runs it through the model to predict churn probability or label.
        5. Output Display: Shows the model’s prediction output, including churn probability if available, and indicates whether the customer is predicted to churn ("Yes") or not ("No").

    * User Interaction
        * Intuitive interface to enter customer features.
        * Immediate churn prediction displayed with clear labeling.

## How To Run

1. Ensure Python environment has required packages : pandas, pycaret, streamlit. (if not, install them using pip install <package_name>)
2. Place the dataset in "Dataset/train.csv.
3. Run main.py to train and save the model(first time only).
4. Run the streamlit app using the command in terminal: streamlit run app.py.
5. Use the web app interface to input customer data and get churn predictions.


### NOTES
* The model training uses automated machine learning to select the best classification model for the churn dataset.
* The app expects inputs to be consistent with the training data features and formats. 
* Columns ignored during training are excluded in prediction inputs to avoid data leakage.
        